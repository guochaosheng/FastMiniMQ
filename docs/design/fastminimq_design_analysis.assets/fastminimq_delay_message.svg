<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="598px" height="406px" viewBox="-0.5 -0.5 598 406" content="&lt;mxfile modified=&quot;2020-07-27T02:03:48.915Z&quot; host=&quot;www.liuchengtu.com&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36&quot; etag=&quot;1iGEg5X4Dgb1nIvARloe&quot; version=&quot;11.1.4&quot; type=&quot;online&quot;&gt;&lt;diagram id=&quot;h6m8giriB5MFzYI3FJRf&quot; name=&quot;第 1 页&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="92" y="110" width="125" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(108.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="91" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 93px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">message record 4</div></div></foreignObject><text x="46" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">message record 4</text></switch></g><rect x="217" y="110" width="125" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(233.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="91" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 93px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">message record 3</div></div></foreignObject><text x="46" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">message record 3</text></switch></g><rect x="342" y="110" width="125" height="30" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(358.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="91" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 93px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">message record 2</div></div></foreignObject><text x="46" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">message record 2</text></switch></g><rect x="467" y="110" width="125" height="30" fill="#cccccc" stroke="#000000" pointer-events="none"/><g transform="translate(483.5,118.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="91" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 91px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">message record 1</div></div></foreignObject><text x="46" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">message record 1</text></switch></g><rect x="342" y="70" width="125" height="30" rx="4.5" ry="4.5" fill="none" stroke="#000000" stroke-dasharray="1 2" pointer-events="none"/><g transform="translate(368.5,78.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="72" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 73px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font>入队时间最早</font></div></div></foreignObject><text x="36" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">&lt;font&gt;入队时间最早&lt;/font&gt;</text></switch></g><rect x="92" y="0" width="420" height="30" rx="4.5" ry="4.5" fill="#ffffff" stroke="#000000" stroke-dasharray="1 2" pointer-events="none"/><g transform="translate(117.5,8.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="368" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 370px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><font>一个 topic 只能容纳相同定时时间的定时消息，定时时间可以任意指定</font></div></div></foreignObject><text x="184" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">&lt;font&gt;一个 topic 只能容纳相同定时时间的定时消息，定时时间可以任意指定&lt;/font&gt;</text></switch></g><path d="M 7 90 L 100.63 90" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 105.88 90 L 98.88 93.5 L 100.63 90 L 98.88 86.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(34.5,68.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="24" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 25px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">入队</div></div></foreignObject><text x="12" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">入队</text></switch></g><rect x="92" y="200" width="505" height="70" rx="10.5" ry="10.5" fill="#ffffff" stroke="#000000" stroke-dasharray="1 2" pointer-events="none"/><g transform="translate(94.5,214.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="501" height="40" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 501px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">场景：下单后 2小时后未付款自动关闭订单<br />所有进入队列的消息 2小时后才能消费，读取消息时会检查第一个未消费消息入队时间是否已经达到可消费时间点</div></div></foreignObject><text x="251" y="26" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">场景：下单后 2小时后未付款自动关闭订单&lt;br&gt;所有进入队列的消息 2小时后才能消费，读取消息时会检查第一个未消费消息入队时间是否已经达到可消费时间点</text></switch></g><rect x="92" y="140" width="375" height="30" fill="#ffffff" stroke="#000000" stroke-dasharray="1 2" pointer-events="none"/><g transform="translate(261.5,148.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 37px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">未消费</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">未消费</text></switch></g><rect x="467" y="140" width="125" height="30" fill="#ffffff" stroke="#000000" stroke-dasharray="1 2" pointer-events="none"/><g transform="translate(511.5,148.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="36" height="12" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 37px; white-space: nowrap; overflow-wrap: normal; text-align: center;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;">已消费</div></div></foreignObject><text x="18" y="12" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">已消费</text></switch></g><path d="M 467 170 L 467 40" fill="none" stroke="#666666" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><rect x="92" y="163" width="500" height="16" fill="#ffffff" stroke="none" pointer-events="none"/><rect x="92" y="291" width="505" height="114" rx="17.1" ry="17.1" fill="#ffffff" stroke="#000000" stroke-dasharray="1 2" pointer-events="none"/><g transform="translate(94.5,306.5)"><switch><foreignObject style="overflow:visible;" pointer-events="all" width="501" height="82" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; font-size: 12px; font-family: Georgia; color: rgb(0, 0, 0); line-height: 1.2; vertical-align: top; width: 501px; white-space: nowrap; overflow-wrap: normal; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;text-align:inherit;text-decoration:inherit;white-space:normal;"><div>选择 producer 端 还是 consumer 端指定定时时间？</div><div>答：选择 consumer 端指定定时时间，这样可以更灵活，consumer 端可以根据需要随时变更消费时间，如果是 producer 端指定，存储日志就需要增加定时时间字段，且一旦指定变更就变得困难，<span>选择 consumer 端指定定时时间，broker 只需要在消息入队存储时增一个时间戳，而这个时间戳本身也用于调用链路追踪，性能分析等场景，因此，选择 consumer 端指定定时时间比选择 producer 端指定定时时间更轻量，逻辑简单性能高，用户API灵活性更好。 </span></div></div></div></foreignObject><text x="251" y="47" fill="#000000" text-anchor="middle" font-size="12px" font-family="Georgia">[Not supported by viewer]</text></switch></g></g></svg>